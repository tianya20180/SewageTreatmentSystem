<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qdu.diaisheng.dao.DataVauleDao">
    <insert id="insertDataVaule" keyProperty="dataValueId" keyColumn="data_value_id">
        insert into data_value(data_value_id,data_point_id,val,create_time)
        values
        (#{dataValueId},#{dataPoint.dataPointId},#{value},DATE_FORMAT(#{createTime}, '%Y-%m-%d %H:%i:%S'))
    </insert>
    <resultMap id="dataValueMap" type="com.qdu.diaisheng.entity.DataValue">
        <id column="data_value_id" property="dataValueId"/>
        <result column="val" property="value"/>
        <result column="creat_time" property="createTime"/>
        <association property="dataPoint" column="data_point_id" javaType="com.qdu.diaisheng.entity.DataPoint">
            <id column="data_point_id" property="dataPointId"/>
            <result column="data_point_name" property="dataPointName"/>
        </association>
    </resultMap>

    <select id="queryByDataPointId" parameterType="String" resultMap="dataValueMap">
       select*from data_value where data_point_id=#{dataPointId}
    </select>


    <select id="queryByDate" parameterType="String" resultMap="dataValueMap">
        select*from data_value where create_time=#{date}
    </select>


  

    <select id="queryByDateAndPointID" resultMap="dataValueMap">
        select*from data_value where create_time=#{date} and data_point_id=#{dataPointId}
    </select>

    <select id="queryBetweenDateAndPonitId" resultMap="dataValueMap">
        select*from data_value where data_point_id=#{dataPointId} and create_time between DATE_FORMAT(#{date1}, '%Y-%m-%d %H:%i:%S') and DATE_FORMAT(#{date2}, '%Y-%m-%d %H:%i:%S');
    </select>

</mapper>